# Пагинация

## Задание

Реализуйте пагинацию по csv-файлу с [портала открытых данных](https://data.mos.ru/datasets/752), содержащего список остановок наземного общественного транспорта.

Для этого необходимо реализовать функцию отображение `stations.views.bus_stations`, формируя контекст, как показано в примере.

Путь к файлу хранится в настройках `settings.BUS_STATION_CSV`.

Для чтения csv-файла можете использовать [DictReader](https://docs.python.org/3/library/csv.html#csv.DictReader) и учтите, что файл в кодировке `utf-8`.

![Пример результата](./res/result.png)

## Документация по проекту

Для запуска проекта необходимо

Установить зависимости:

```bash
pip install -r requirements.txt
```

Выполнить команду:

```bash
python manage.py runserver
```


### Что было сделано:

В рамках проекта было выполнено следующее:

1. **Создание представлений и шаблонов**:
    - Было создано представление для отображения списка автобусных станций.
    - В представлении используется файл CSV, содержащий информацию о станциях, который обрабатывается с использованием стандартного Python-модуля `csv`.
2. **Реализация пагинации**:
    - Список станций был разбит на страницы с помощью класса `Paginator` из Django.
    - Каждая страница содержит 10 станций.
    - В контекст передаётся текущая страница и список станций, соответствующий данной странице.
    - При помощи метода `Paginator.get_page()` обеспечивается корректная работа с номером страницы, даже если введены некорректные значения в запросе.
3. **Обработка запросов**:
    - В представлении `bus_stations` обрабатываются запросы GET для получения номера страницы из параметров запроса.
    - Если номер страницы не указан или некорректен, отображается первая страница.
4. **Шаблоны**:
    - Создан шаблон `stations/index.html`, в котором выводятся автобусные станции на текущей странице и элементы навигации для перехода между страницами.

### Пример кода:

```python
import csv
from django.shortcuts import render, redirect
from django.urls import reverse
from django.core.paginator import Paginator
from django.conf import settings

def index(request):
    return redirect(reverse('bus_stations'))

def bus_stations(request):
    # Получаем данные из CSV файла
    with open(settings.BUS_STATION_CSV, newline='', encoding='utf-8') as csvfile:
        reader = csv.DictReader(csvfile)
        bus_stations_list = list(reader)

    # Пагинация с 10 станциями на страницу
    paginator = Paginator(bus_stations_list, 10)

    # Получаем номер страницы из запроса
    try:
        page_number = int(request.GET.get('page', 1))
    except:
        page_number = 1

    # Получаем страницу
    page = paginator.get_page(page_number)

    # Передаем данные в шаблон
    context = {
        'bus_stations': page.object_list,
        'page': page,
    }
    return render(request, 'stations/index.html', context)

```

### Задачи, решенные этим кодом:

- **Обработка CSV-файлов**: Информация об автобусных станциях загружается из CSV-файла, парсится и используется для дальнейшего отображения на страницах.
- **Пагинация**: Реализована простая и понятная пагинация для списка станций, которая позволяет пользователю легко перемещаться между страницами.
- **Обработка GET-запросов**: Номер страницы извлекается из запроса и корректно обрабатывается для обеспечения плавной работы навигации.

Таким образом, реализованная функциональность соответствует требованиям задачи по обработке запросов, рендерингу шаблонов и пагинации данных.